<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>PlugBoard Architecture</TITLE>
<META NAME="description" CONTENT="PlugBoard Architecture">
<META NAME="keywords" CONTENT="architecture">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="architecture.css">

</HEAD>

<BODY >
<!--Navigation Panel-->
<IMG WIDTH="81" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next_inactive"
 SRC="file:/usr/local/share/lib/latex2html/icons/nx_grp_g.png"> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/local/share/lib/latex2html/icons/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/local/share/lib/latex2html/icons/prev_g.png">   
<BR>
<BR>
<BR>
<!--End of Navigation Panel-->

<P>

<P>
<H1 ALIGN="CENTER">PlugBoard Architecture</H1>
<DIV>

<P ALIGN="CENTER"><STRONG><I>Bruno Luca</I></STRONG></P>
</DIV>

<P>

<H1><A NAME="SECTION00100000000000000000">
1. Components</A>
</H1>

<P>
The main component of the framework is the <B>application interface</B>
(iapplication) used for reference by all other components:
it should be initialized before using any other component. The application
implementation should do nothing else that add some useful functions
and hooks (such as adapters) to let the development be as the easier
and faster as possible.

<P>
After the application initialization, registered plugins (iplugin)
must be found trough a plugin resource manager (ipluginresource).
The plugin resources then adds internally all found plugins and register
itself (<I>the instance</I>) as an iapplication adapter,
so that the application could implement its own plugin resource following
the interface scheme.

<P>
At this point, the application is configured and ready to be loaded
using the context resource (icontextresource), which groups
some plugins and loads them passing for the following three states:

<P>

<UL>
<LI><B>initialization</B>: loads all internal plugin variables without
any interaction with other plugins
</LI>
<LI><B>preloading</B>: perform initialization actions with other plugins
and their initialized options (e.g. connecting to plugin events)
</LI>
<LI><B>loading:</B> this is the last step, where all plugins could perform
any action to interact with other plugins
</LI>
</UL>
<I>This loading feature is indeed to remove all dependencies among
plugins</I>

<P>
Just after the initialization of each plugin, the plugin instance
is registered as an adapter of iapplication so plugins could
reach other plugins adapting the application to the requested plugin
interface.<A NAME="tex2html1"
  HREF="#foot28"><SUP>1.1</SUP></A>
<P>
The last optional but recomended component is the <B>engine</B>
(iengine). It's something like a protocol that specifies
how plugin communicate each other trough events and contain some useful
utilities for a specified environment. Mandatory engine components
are the event dispather (ieventdispatcher, registered as
an adaptiong for iplugin) and its events (ievent,
adaption for ieventdispatcher).

<P>
Then each plugin could have its own event dispatcher based on the
current engine to let other plugins connect to it.

<P>
Event connecting is also simplified by the <B>event connector</B>.
Its behavior consists in getting all objects contained in self starting
with <I>``on_''</I> and connecting them as callbacks for the
rest of the object name as the event name to the specified plugin.
Usually, it doesn't need to be implemented for each different engine
since it uses the engine abstraction.

<P>

<H1><A NAME="SECTION00200000000000000000">
2. Builtin plugin resources</A>
</H1>

<P>

<H1><A NAME="SECTION00210000000000000000">
2.1 Setuptools</A>
</H1>

<P>
The setuptools plugin resource is used to gain the list of application
plugins registered using setuptools entry points.

<P>
A simple usage:

<P>
<BLOCKQUOTE>
from plugboard import plugin
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>plugin.SetuptoolsPluginResource(application, 'application.entry.point').refresh()

</BLOCKQUOTE>

<P>

<H1><A NAME="SECTION00300000000000000000">
3. Builtin context resources</A>
</H1>

<P>

<H1><A NAME="SECTION00310000000000000000">
3.1 XML</A>
</H1>

<P>
This resource gains context informations from a <I>xml.dom.minidom.Element</I>
element, looking in its children.

<P>
A simple usage:

<P>
<BLOCKQUOTE>
from xml.dom import minidom
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>xmlstr = ``''''&lt;root&gt;
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>&lt;context name='ctx1'&gt;
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>&lt;plugin path='app.plugins.APlugin' /&gt;
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>&lt;plugin path='app.plugins.BPlugin' /&gt;
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>&lt;/context&gt;
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>``''''
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>from plugboard import context
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>context.XMLContextResource(application, minidom.parseString(xmlstr).documentElement).refresh()

</BLOCKQUOTE>

<P>

<H1><A NAME="SECTION00400000000000000000">
4. Builtin engines</A>
</H1>

<P>

<H1><A NAME="SECTION00410000000000000000">
PlugBoard</A>
</H1>

<P>
The PlugBoard engine doesn't define any utility for applications,
since it's the most general purpose engine. However, it has a really
simple method for event dispatching: it stores observer callbacks
and call them when an <I>emit</I> is requested.

<P>

<H1><A NAME="SECTION00420000000000000000">
GTK</A>
</H1>

<P>
This engine can be used in GTK 2.8 or above, since it exploits the
creation of GTK signals<A NAME="tex2html2"
  HREF="#foot92"><SUP>4.1</SUP></A> into a generic <I>GObject</I>. So, everytime a signal is requested
to be created, a new gobject is instantiated. To grant the integrity
of the first argument passed to the callback to be the plugin instance
and not the gobject when firing the event, <I>connect_object</I>
is used instead of <I>connect</I>.

<P>

<H1><A NAME="SECTION00500000000000000000">
5. Engine utilities</A>
</H1>

<P>

<H1><A NAME="SECTION00510000000000000000">
5.1 EventConnector</A>
</H1>

<P>
This class automatically connects its callable attributes beggining
with <I>``on_''</I> to the specified plugin. The event name to
be used is described in the object name itself, just after the ``on_''
string: for example ``on_new'' would connect to the event ``new''.
For instance, these callable objects (usually methods) could hold
an attribute called <I>extra</I> which contains extra arguments to
be passed to the <I>connect</I> method of ievent.

<P>
A simple usage:

<P>
<BLOCKQUOTE>
from plugboard import plugin, engine
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>from zope.interface import implements
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>import interfaces
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>class APlugin(plugin.Plugin):

<BLOCKQUOTE>
implements(interface.IAPlugin)
</BLOCKQUOTE></BLOCKQUOTE>
<P>
<BLOCKQUOTE><BLOCKQUOTE>def __init__(self, application):

<BLOCKQUOTE>
self.dispatcher = engine.IEventDispatcher(self)
</BLOCKQUOTE></BLOCKQUOTE></BLOCKQUOTE>
<P>
<BLOCKQUOTE><BLOCKQUOTE><BLOCKQUOTE>self.dispatcher.add_event('new', (str, 'Some data type'))

</BLOCKQUOTE>
def load(self, context):

<BLOCKQUOTE>
self.dispatcher['new'].emit('Some data')

</BLOCKQUOTE>
</BLOCKQUOTE>
class BToAEventConnector(engine.EventConnector):

<BLOCKQUOTE>
def on_new(self, plugin, data, extra):

<BLOCKQUOTE>
<I>...</I>

</BLOCKQUOTE>
</BLOCKQUOTE>
class BPlugin(plugin.Plugin):

<BLOCKQUOTE>
implements(interfaces.IBPlugin)
</BLOCKQUOTE></BLOCKQUOTE>
<P>
<BLOCKQUOTE><BLOCKQUOTE>def preload(self, application):

<BLOCKQUOTE>
ec = BToAEventConnector(interfaces.IAPlugin(application))
</BLOCKQUOTE></BLOCKQUOTE></BLOCKQUOTE>
<P>
<BLOCKQUOTE><BLOCKQUOTE><BLOCKQUOTE>ec.on_new.extra = ('first extra argument',)

</BLOCKQUOTE>
</BLOCKQUOTE>
</BLOCKQUOTE>

<P>

<H1><A NAME="SECTION00600000000000000000">
6. Basic tutorial</A>
</H1>

<P>
*TODO

<P>

<H1><A NAME="SECTION00700000000000000000">
7. Advanced application</A>
</H1>

<P>
*TODO

<H1><A NAME="SECTION00800000000000000000">
About this document ...</A>
</H1>
 <STRONG>PlugBoard Architecture</STRONG><P>
This document was generated using the
<A HREF="http://www.latex2html.org/"><STRONG>LaTeX</STRONG>2<tt>HTML</tt></A> translator Version 2002-2-1 (1.71)
<P>
Copyright &#169; 1993, 1994, 1995, 1996,
<A HREF="http://cbl.leeds.ac.uk/nikos/personal.html">Nikos Drakos</A>, 
Computer Based Learning Unit, University of Leeds.
<BR>
Copyright &#169; 1997, 1998, 1999,
<A HREF="http://www.maths.mq.edu.au/~ross/">Ross Moore</A>, 
Mathematics Department, Macquarie University, Sydney.
<P>
The command line arguments were: <BR>
 <STRONG>latex2html</STRONG> <TT>-no_subdir -split 0 -show_section_numbers architecture.tex</TT>
<P>
The translation was initiated by  on 2006-02-12
<BR><HR><H4>Footnotes</H4>
<DL>
<DT><A NAME="foot28">...</A><A
 HREF="architecture.html#tex2html1"><SUP>1.1</SUP></A></DT>
<DD>It's important to specify a different interface for all plugins. Note
that registering an adaption replaces the previous one, so there can
be only one interface implementation in each context.

</DD>
<DT><A NAME="foot92">... signals</A><A
 HREF="architecture.html#tex2html2"><SUP>4.1</SUP></A></DT>
<DD>This can be done using the special class variable <I>__gsignals__</I>.
Read PyGTK FAQs for more informations.

</DD>
</DL><HR>
<!--Navigation Panel-->
<IMG WIDTH="81" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next_inactive"
 SRC="file:/usr/local/share/lib/latex2html/icons/nx_grp_g.png"> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/local/share/lib/latex2html/icons/up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/local/share/lib/latex2html/icons/prev_g.png">   
<BR>
<!--End of Navigation Panel-->
<ADDRESS>

2006-02-12
</ADDRESS>
</BODY>
</HTML>
